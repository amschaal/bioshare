{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load guardian_tags %}
{% load compress %}
{% block title %}Shares{% endblock %}
{% block content %}
<h2>Shares</h2>
{% if bad_paths %}
<h3>The following shares have non existent paths. View <a href="{% url 'home' %}">all shares.</a></h3>
{% endif %}

 <div ng-controller="SharesController" ng-init="init()">
	    {% verbatim %}
	    <h4>Fields</h4>
            <div style="margin-bottom: 20px">
		        <label class="checkbox-inline" ng-repeat="(col,val) in cols">
		          <input type="checkbox" ng-model-options="{ getterSetter: true }" ng-model="cols[col]"/> {{col}}
		        </label>
		      </div>
	     <table ng-table="tableParams" class="limit-col-width table table-bordered table-striped table-condensed">
	      <tr ng-repeat="row in $data track by row.id">
	        <td ng-if="cols['Share']" data-title="'Share'" filter="{name__icontains: 'text'}" sortable="'name'"><a href="{{row.url}}"">{{row.name}}</a></td>
	        <td ng-if="cols['Description']" data-title="'Description'" filter="{notes__icontains: 'text'}">{{row.notes}}</td>
	        <td ng-if="cols['Tags']" data-title="'Tags'" filter="{tags: 'text'}"><span ng-repeat="tag in row.tags"><a>{{tag.name}}</a>{{$last ? '' : ', '}}</span></td>
	        <td ng-if="cols['Owner']" data-title="'Owner'" filter="{owner__username__icontains: 'text'}" sortable="'owner__username'">{{row.owner.username}}</td>
	        <td ng-if="cols['Users']" data-title="'Users'" filter="{user: 'text'}"><span ng-repeat="u in row.users">{{u}}{{$last ? '' : ', '}}</span></td>
	        <td ng-if="cols['Groups']" data-title="'Groups'" filter="{group: 'text'}"><span ng-repeat="g in row.groups">{{g}}{{$last ? '' : ', '}}</span></td>
	        <td ng-if="cols['Created']" data-title="'Created'" sortable="'created'">{{row.created | date : 'short'}}</td>
	        <td ng-if="cols['Modified']" data-title="'Modified'" sortable="'updated'">{{row.updated | date : 'short'}}</td>
	        <td ng-if="cols['Files']" data-title="'Files*'" sortable="'stats__num_files'">{{row.stats.num_files}}</td>
	        <td ng-if="cols['Size']" data-title="'Size*'" sortable="'stats__bytes'">{{row.stats.bytes | bytes}}</td>
	      </tr>
	    </table>
	    {% endverbatim %}
</div>

<p>
{{total_size}} of storage being used by {{request.user.username}}.*
</p>
*Files statistics updated daily.
{% endblock %}

{% block scripts %}
{{block.super}}
{% compress js %}
<script src="{% static "js/services/ng-table-services.js" %}"></script>
<script src="{% static "js/controllers/shares-controller.js" %}"></script>
{% endcompress %}
{% endblock %}